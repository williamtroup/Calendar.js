<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Calendar.js - Fetch From Trigger</title>
        <link rel="stylesheet" href="../css/styles.css">
        <link rel="stylesheet" href="../../dist/calendar.js.css">
        <script src="../../dist/calendar.js"></script>
    </head>

    <body>
        <div class="header">
            <h1 id="header">Calendar.js - Fetch From Trigger</h1>
            <p>A test that shows Calendar.js being populated from events fetched from a custom trigger.</p>
        </div>

        <div class="contents">
            <div id="calendar" style="max-width: 800px;"></div>
        </div>
    </body>

    <script>
        var calendarInstance = new calendarJs( "calendar", {
            events: {
                onEventsFetch: getEvents
            }
        } );

        document.title += " v" + calendarInstance.getVersion();
        document.getElementById( "header" ).innerText += " - v" + calendarInstance.getVersion();

        function daysInMonth( year, month ) {
            return new Date( year, month + 1, 0 ).getDate();
        }

        function getEvents() {
            var previousDay = new Date(),
                today9 = new Date(),
                today11 = new Date(),
                tomorrow = new Date(),
                firstDayInNextMonth = new Date(),
                lastDayInNextMonth = new Date(),
                today = new Date(),
                today3HoursAhead = new Date(),
                previousYear = new Date(),
                nextYear = new Date(),
                overlappingEvent1 = new Date(),
                overlappingEventTo1 = new Date(),
                overlappingEvent2 = new Date(),
                overlappingEventTo2 = new Date(),
                overlappingEvent3 = new Date(),
                overlappingEventTo3 = new Date(),
                overlappingEvent4 = new Date(),
                overlappingEventTo4 = new Date(),
                overlappingEvent5 = new Date(),
                overlappingEventTo5 = new Date();

            previousDay.setDate( previousDay.getDate() - 1 );
            today11.setHours( 11 );
            tomorrow.setDate( today11.getDate() + 1 );
            today9.setHours( 9 );

            firstDayInNextMonth.setDate( 1 );
            firstDayInNextMonth.setDate( firstDayInNextMonth.getDate() + daysInMonth( firstDayInNextMonth.getFullYear(), firstDayInNextMonth.getMonth() ) );

            lastDayInNextMonth.setDate( 1 );
            lastDayInNextMonth.setMonth( lastDayInNextMonth.getMonth() + 1 );
            lastDayInNextMonth.setDate( lastDayInNextMonth.getDate() + daysInMonth( lastDayInNextMonth.getFullYear(), lastDayInNextMonth.getMonth() ) - 1 );

            today.setHours( 21, 59, 0, 0 );
            today.setDate( today.getDate() + 3 );
            today3HoursAhead.setHours( 23, 59, 0, 0 );
            today3HoursAhead.setDate( today3HoursAhead.getDate() + 3 );

            previousYear.setFullYear( previousYear.getFullYear() - 1 );
            nextYear.setFullYear( nextYear.getFullYear() + 1 );

            overlappingEvent1.setDate( overlappingEvent1.getDate() - 3 );
            overlappingEventTo1.setDate( overlappingEventTo1.getDate() - 3 );
            overlappingEvent2.setDate( overlappingEvent2.getDate() - 3 );
            overlappingEventTo2.setDate( overlappingEventTo2.getDate() - 3 );
            overlappingEvent3.setDate( overlappingEvent3.getDate() - 3 );
            overlappingEventTo3.setDate( overlappingEventTo3.getDate() - 3 );
            overlappingEvent4.setDate( overlappingEvent4.getDate() - 3 );
            overlappingEventTo4.setDate( overlappingEventTo4.getDate() - 3 );
            overlappingEvent5.setDate( overlappingEvent5.getDate() - 3 );
            overlappingEventTo5.setDate( overlappingEventTo5.getDate() - 3 );
            overlappingEvent1.setHours( 0, 10, 0, 0 );
            overlappingEventTo1.setHours( 1, 10, 0, 0 );
            overlappingEvent2.setHours( 0, 35, 0, 0 );
            overlappingEventTo2.setHours( 1, 35, 0, 0 );
            overlappingEvent3.setHours( 1, 20, 0, 0 );
            overlappingEventTo3.setHours( 2, 20, 0, 0 );
            overlappingEvent4.setHours( 2, 0, 0, 0 );
            overlappingEventTo4.setHours( 3, 0, 0, 0 );
            overlappingEvent5.setHours( 3, 30, 0, 0 );
            overlappingEventTo5.setHours( 4, 40, 0, 0 );

            return [
            {
                    id: "1",
                    from: overlappingEvent1,
                    to: overlappingEventTo1,
                    title: "Overlapping Event 1",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    location: "Teams Meeting",
                    group: "Group 1",
                    type: 1,
                    customTags: { 
                        testTag: true
                    }
                },
                {
                    id: "2",
                    from: overlappingEvent2,
                    to: overlappingEventTo2,
                    title: "Overlapping Event 2",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    location: "Teams Meeting",
                    group: "Group 1",
                    type: 1,
                    customTags: true
                },
                {
                    id: "3",
                    from: overlappingEvent3,
                    to: overlappingEventTo3,
                    title: "Overlapping Event 3",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    location: "Teams Meeting",
                    group: "Group 1",
                    type: 1,
                    customTags: [ 1 ]
                },
                {
                    id: "4",
                    from: overlappingEvent4,
                    to: overlappingEventTo4,
                    title: "Overlapping Event 4",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    location: "Teams Meeting",
                    group: "Group 1",
                    type: 1,
                    customTags: 1
                },
                {
                    id: "5",
                    from: overlappingEvent5,
                    to: overlappingEventTo5,
                    title: "Overlapping Event 5",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    location: "Teams Meeting",
                    group: "Group 1",
                    type: 1,
                    customTags: "Test Tag"
                },
                {
                    id: "6",
                    from: previousYear,
                    to: previousYear,
                    title: "Previous Year",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    location: "Teams Meeting",
                    isAllDay: true,
                    group: "Group 2",
                    type: 2
                },
                {
                    id: "7",
                    from: nextYear,
                    to: nextYear,
                    title: "Next Year",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    location: "Teams Meeting",
                    isAllDay: true,
                    group: "Group 2",
                    type: 2
                },
                {
                    id: "8",
                    from: previousDay,
                    to: previousDay,
                    title: "Previous Day",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    location: "Teams Meeting",
                    isAllDay: true,
                    color: "#FF0000",
                    colorText: "#FFFF00",
                    colorBorder: "#00FF00",
                    repeatEvery: 5,
                    id: "1234-5678-9",
                    group: "Group 1",
                    locked: true,
                    type: 3
                },
                {
                    id: "9",
                    from: today11,
                    to: tomorrow,
                    title: "Title 1",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    location: "Teams Meeting",
                    isAllDay: false,
                    group: "group 1"
                },
                {
                    id: "10",
                    from: tomorrow,
                    to: today11,
                    title: "Title Bad (should not show)",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    location: "Teams Meeting",
                    isAllDay: false,
                    group: "group 1",
                    type: 0
                },
                {
                    id: "11",
                    from: today9,
                    to: today9,
                    title: "Title 2",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    location: "Teams Meeting",
                    isAllDay: true,
                    group: "Group 1",
                    url: "https://www.google.com/",
                    type: 4
                },
                {
                    id: "12",
                    from: firstDayInNextMonth,
                    to: firstDayInNextMonth,
                    title: "First Day 1",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    location: "Teams Meeting",
                    isAllDay: true,
                    color: "#00FF00",
                    colorText: "#FF0000",
                    repeatEvery: 4,
                    type: 0
                },
                {
                    id: "13",
                    from: firstDayInNextMonth,
                    to: firstDayInNextMonth,
                    title: "First Day 2",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    location: "Teams Meeting",
                    isAllDay: true,
                    color: "#00FF00",
                    colorText: "#FF0000",
                    repeatEvery: 4,
                    type: 0
                },
                {
                    id: "14",
                    from: lastDayInNextMonth,
                    to: lastDayInNextMonth,
                    title: "Last Day 1",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    location: "Teams Meeting",
                    isAllDay: true,
                    color: "#0000FF",
                    repeatEvery: 2,
                    type: 0
                },
                {
                    id: "15",
                    from: today,
                    to: today3HoursAhead,
                    title: "Regular Event",
                    description: "This is a another <b>description</b> of the event that has been added, so it can be shown in the pop-up dialog.",
                    repeatEvery: 1,
                    repeatEveryExcludeDays: [ 6, 0 ],
                    repeatEnds: new Date( today.getFullYear() + 1, 0, 1 ),
                    group: "Group 1",
                    type: 0
                }
            ];
        }
    </script>
</html>